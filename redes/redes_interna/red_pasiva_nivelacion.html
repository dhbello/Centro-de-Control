<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Centro de Control Geod&eacute;sico Nacional</title>
    <link rel="icon" href="images-home/logos/favicon.png">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css"
        integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.12.1/css/jquery.dataTables.css">
    <link href="../../css/style.css" rel="stylesheet">
    <link href="../../css/maestra.css" rel="stylesheet">
</head>
<body class="main redes geodesicaMaestra redPasivaPagina">
    <nav class="navbarigac origen">
    </nav>
    <nav class="nav nav-underline">
    </nav>
    <section class="portada-igac portadaSub redPasiva">
        <div class="container block-igac">
            <div class="d-flex contenido-portada">
                <a class="get-back" href="../red_geodesica.html"><img src="/images/iconos/arrow-back.svg" alt="">Volver
                    a la Red Geodésica GNSS</a>
                <div class="texto-portada">
                    <h1>Red Pasiva y de Nivelaci&oacute;n</h1>
                    <p>
                        Es la red compuesta de v&eacute;rtices materializados en campo en monumentaciones tipo mojones,
                        pilastras, incrustaciones y obeliscos. En el caso colombiano, los datos coordenados de la Red
                        Geod&eacute;sica GNSS Nacional Pasiva, se encuentran vinculados al IRTF 2014, &eacute;poca de
                        referencia 2018.0 y elipsoide GRS-80.
                    </p>
                </div>
            </div>
        </div>
    </section>
    <div class="container containerIgac">
        <section class="section visor row">
            <div class="iframe col-md-12">
                <div class="d-flex position-relative align-items-center justify-content-end">
                    <h2 class="title w-divider text-center">Mapa de la red Pasiva y de nivelación</h2>
                    <div class="status d-flex position-absolute">
                        <a class="btn mb-4 text-center buttonCem">Ver en CEM</a>
                    </div>
                </div>
                <div id="viewDiv"></div>
            </div>
        </section>
    </div>


    <div class="typeB">
        <div class="container containerIgac">        
            <section class="section">
                <div class="m-auto w-100">
                    <table id="tbl" class="display">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Municipio,departamento</th>
                                <th>Estado</th>
                                <th>Nombre de la red</th>
                                <th>Entidad</th>
                                <th></th>
                            </tr>
                        </thead>
                    </table>
                    
                </div>
            </section>
        </div>
    </div>



    <div class="containercolor indicadoresMaestraRedes">
        <div class="position-relative">
            <div class="container containerIgac borderB">
                <section class="section indicadores">
                    <div class="d-fex">
                        <div class="text">
                            <div class="title">
                                Indicadores
                            </div>
                            <p>A continuaci&oacute;n, encontraras algunas cifras importantes respecto al estado y
                                funcionamiento la Red GNSS Pasiva materializada en el territorio colombiano:</p>
                        </div>
                    </div>
                    <img src="/images/images-redes/flowerIndicadores.svg" alt="">
                </section>
            </div>
            <div class="board">
                <div class="card">
                    <div class="d-flex">
                        <div class="item">
                            <div class="d-flex">
                                <div class="icon">
                                    <img src="/images/iconos/mapIcon.svg" alt="">
                                </div>
                                <div class="content">
                                    <div class="number" id="stat1">0</div>
                                    <div class="text" >Número total de vertices geodésicos</div>
                                </div>
                            </div>
                        </div>
                        <div class="item">
                            <div class="d-flex">
                                <div class="icon">
                                    <img src="/images/iconos/moveIcon.svg" alt="">
                                </div>
                                <div class="content">
                                    <div class="number" id="stat2">0</div>
                                    <div class="text" >Número de entidades contribuyentes</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="d-flex">
                        <div class="item">
                            <div class="d-flex">
                                <div class="icon">
                                    <img src="/images/iconos/tableIcon.svg" alt="">
                                </div>
                                <div class="content">
                                    <div class="number" id="stat3">0</div>
                                    <div class="text">Número de vertices validados</div>
                                </div>
                            </div>
                        </div>
                        <div class="item">
                            <div class="d-flex">
                                <div class="icon">
                                    <img src="/images/iconos/dataIcon.svg" alt="">
                                </div>
                                <div class="content">
                                    <div class="number" id="stat4">0</div>
                                    <div class="text">% de municipios cubiertos por la red</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>        
    </div>
    <!--<section class="section sectionEstaciones">
        <div class="resourses-title" style="text-align: center;">
            <h2>V&eacute;rtices de la red</h2>
        </div>
        <div class="row">
            <div class="m-auto">
                <table id="tbl" class="display">
                    <thead>
                        <tr>
                            <th>Identificador</th>
                            <th>Municipio, departamento</th>
                            <th>Estado</th>
                            <th>Nombre de la red</th>
                            <th>Entidad</th>
                            <th>Ver</th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
    </section>-->
    <section class="section registrarReportar noBefore paddingLast">
        <div class="container containerIgac">
            <div class="d-flex">
                <div class="containerFaqs typeB">
                    <div class="faqs typeC">
                        <div class="title m-0 mb-3">
                            Registra una nueva estaci&oacute;n
                        </div>
                        <div class="d-flex align-items-center modalEstaciones" data-toggle="modal"
                            data-target="#modalEstaciones">
                            <div class="boton-faqs">
                                <a>Iniciar formulario</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="containerFaqs typeB">
                    <div class="faqs typeD">
                        <div class="title m-0 mb-3">
                            Reporta una novedad
                        </div>
                        <div style="white-space: nowrap;"
                            class="p-0 col-md-4 text-center modalButtonReportar boton-faqs" data-toggle="modal"
                            data-target="#reportarModal">
                            <a>Iniciar formulario</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <div class="containercolor">
        <div class="container containerIgac">
            <section class="section sumary">
                <h2 class="title w-divider">Recursos destacados</h2>
                <div class="divider w-title"></div>
                <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                    <div class="carousel-inner">
                        <div class="carousel-item active">
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="card shadow-sm blue">
                                        <div class="card-header">
                                            <h5>Aplicaciones y Herramientas</h5>
                                        </div>
                                        <div class="card-body">
                                            <h6>MAGNA SIRGAS PRO 5.1</h6>
                                            <p class="card-text">Esta herramienta permite la conversión y transformación
                                                de coordenadas, cálculo de ondulación geoidal, nivelación GPS, cálculos
                                                elipsoidales, cálculo de velocidades y cambio de época para un conjunto
                                                de coordenadas especificadas.</p>
                                            <div class="d-flex align-items-center justify-content-center">
                                                <button type="button" class="btn btn-sm btn-default">Visitar</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card shadow-sm orange">
                                        <div class="card-header">
                                            <h5>Modelos</h5>
                                        </div>
                                        <div class="card-body">
                                            <h6>Modelo Geoidal</h6>
                                            <p class="card-text">Acá, podrás descargar el modelo GEOCOL más reciente
                                                para visualizar las alturas geoidales que se usan en la determinación de
                                                altura físicas en el Territorio Colombiano.</p>
                                            <div class="d-flex align-items-center justify-content-center">
                                                <button type="button" class="btn btn-sm btn-default">Visitar</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card shadow-sm purple">
                                        <div class="card-header">
                                            <h5>Servicios</h5>
                                        </div>
                                        <div class="card-body">
                                            <h6>Servicios en tiempo real</h6>
                                            <p class="card-text">Este módulo direcciona al usuario a la central de
                                                servicios de procesamiento en línea de tipo diferencial y los servicios
                                                de posicionamiento en tiempo real via caster NTRIP para las estaciones
                                                de la Red Activa del Territorio Colombiano.</p>
                                            <div class="d-flex align-items-center justify-content-center">
                                                <button type="button" class="btn btn-sm btn-default">Visitar</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="card shadow-sm blue">
                                        <div class="card-header">
                                            <h5>Aplicaciones y Herramientas</h5>
                                        </div>
                                        <div class="card-body">
                                            <h6>MAGNA SIRGAS PRO 5.1</h6>
                                            <p class="card-text">Esta herramienta permite la conversión y transformación
                                                de coordenadas, cálculo de ondulación geoidal, nivelación GPS, cálculos
                                                elipsoidales, cálculo de velocidades y cambio de época para un conjunto
                                                de coordenadas especificadas.</p>
                                            <div class="d-flex align-items-center justify-content-center">
                                                <button type="button" class="btn btn-sm btn-default">Visitar</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card shadow-sm orange">
                                        <div class="card-header">
                                            <h5>Modelos</h5>
                                        </div>
                                        <div class="card-body">
                                            <h6>Modelo Geoidal</h6>
                                            <p class="card-text">Acá, podrás descargar el modelo GEOCOL más reciente
                                                para visualizar las alturas geoidales que se usan en la determinación de
                                                altura físicas en el Territorio Colombiano.</p>
                                            <div class="d-flex align-items-center justify-content-center">
                                                <button type="button" class="btn btn-sm btn-default">Visitar</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card shadow-sm purple">
                                        <div class="card-header">
                                            <h5>Servicios</h5>
                                        </div>
                                        <div class="card-body">
                                            <h6>Servicios en tiempo real</h6>
                                            <p class="card-text">Este módulo direcciona al usuario a la central de
                                                servicios de procesamiento en línea de tipo diferencial y los servicios
                                                de posicionamiento en tiempo real via caster NTRIP para las estaciones
                                                de la Red Activa del Territorio Colombiano.</p>
                                            <div class="d-flex align-items-center justify-content-center">
                                                <button type="button" class="btn btn-sm btn-default">Visitar</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>
            </section>
        </div>
    </div>
    <footer class="footer origen">
    </footer>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous">
    </script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous">
    </script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.js">
    </script>
    <script src="/index.js"></script>
    <link rel="stylesheet" href="https://js.arcgis.com/4.24/esri/themes/light/main.css">
    <script src="https://js.arcgis.com/4.24/"></script>
    <script>
        require([
            "esri/config",
            "esri/Map",
            "esri/views/MapView",
            "esri/widgets/Home",
            "esri/widgets/ScaleBar",
            "esri/widgets/LayerList",
            "esri/widgets/Legend",
            "esri/widgets/Expand",
            "esri/widgets/Compass",
            "esri/geometry/Extent",
            "esri/layers/MapImageLayer"
        ], (
            esriConfig, Map, MapView, Home, ScaleBar, LayerList, Legend,
            Expand, Compass, Extent, MapImageLayer
        ) => {
            esriConfig.apiKey =
                "AAPK2a2e861a0c794bfdb29a1b4ce47b1583OBbY7CvHSkUPhQ20FG1hZEbAl5GmTTZcs-cyoy2tw5to5j_pJiiTW6J_KRbBx-qS";
            const layer = new MapImageLayer({
                url: "https://mapas.igac.gov.co/server/rest/services/centrocontrol/EstacionesGeodesicas/MapServer",
                sublayers: [{
                    id: 0,
                    visible: true,
                    definitionExpression: "es_pasiva_gnss=1"
                }]
            });
            const map = new Map({
                layers: [layer],
                basemap: "arcgis-topographic"
            });
            const view = new MapView({
                container: "viewDiv",
                map: map
            });
            const homeBtn = new Home({
                view: view
            });
            const scaleBar = new ScaleBar({
                view: view,
                unit: "dual"
            });
            const layerList = new LayerList({
                view: view
            });
            const legend = new Legend({
                view: view
            });
            const layerListExpand = new Expand({
                view: view,
                content: layerList,
                expanded: false,
                expandTooltip: "Expand LayerList"
            });
            const legendExpand = new Expand({
                view: view,
                content: legend,
                expandTooltip: "Expand Legend",
                expanded: false
            });
            const compass = new Compass({
                view: view,
                visible: false
            });
            view.ui.add(homeBtn, "top-left");
            view.ui.add(scaleBar, "bottom-right");
            view.ui.add(layerListExpand, "top-right");
            view.ui.add(legendExpand, "bottom-left");
            view.ui.add(compass, "top-left");
            layer.when(() => {
                const initialExtent = Extent.fromJSON(layer.sourceJSON.initialExtent);
                view.goTo(initialExtent);
            });
            // load the Compass only when the view is rotated
            view.watch('rotation', function (rotation) {
                if (rotation && !compass.visible) {
                    compass.visible = true;
                }
            });
        });
    </script>


<script type="module">

    var table;
    
    import {queryFeatures}  from "https://cdn.skypack.dev/@esri/arcgis-rest-feature-service@4.0.3";
        /* consulta indicador 1 */
        queryFeatures({
            url: "https://mapas.igac.gov.co/server/rest/services/centrocontrol/EstacionesGeodesicas/MapServer/0",
            where: "es_pasiva_gnss =1",
            returnGeometry:'false',
            outStatistics:[{
                    statisticType: "sum",
                    onStatisticField: "es_pasiva_gnss ",
                    outStatisticFieldName: "out"
                }
                ]
            })
            .then((result)=>{
                var draw= result.features[0].attributes.out;
    
                let texto='';
    
                var uri='https://mapas.igac.gov.co/server/rest/services/centrocontrol/EstacionesGeodesicas/MapServer/0/query?where=es_pasiva_gnss=1 '+texto+'&outFields=identificador%2Cagencia_sigla%2Cmunicipio%2Credes%2Cestado&returnGeometry=false&f=pjson';
    
            table= $('#tbl').DataTable({
                    orderCellsTop: true,
                    serverSide: true,
                    fixedHeader: true,
                   searching: false,
                    ajax: {
                        url: uri,
                        data: function (d) {
                            d.resultRecordCount = d.length;
                            d.resultOffset=d.start;
                        },
                        "dataSrc": function ( json ) {
                            console.log(json)
                            var obj=json.features;
                            var arr1=[]
                            Object.keys(obj).forEach(function(key, index) {
                                obj[key].attributes["id"] = index;
                                obj[key].attributes["ir"] = 'interna_red_pasiva.html?estacion=' + obj[key].attributes.identificador+'&nombre='+obj[key].attributes.redes
                                
                                var item=[]
    
                                Object.keys(obj[key].attributes).forEach(function(key2, index) {
                                    item.push(obj[key].attributes[key2])   
                                })
                            
                                arr1.push(obj[key].attributes)
                            });
                           
                            json.recordsTotal = draw
                            json.recordsFiltered = draw
                            json.data=arr1;
     
                            return json.data;
                            },
                    },
                    columns: [
                        {
                            data: 'identificador'
                        },
                        {
                            data: 'municipio'
                        },
                        {
                            data: 'estado',
                            render: function (dataField) {
                                var clase="inactivo"
                                if(dataField==("Activa")){
                                    clase="activo"
                                }else if(dataField==null){
                                clase="vacio";
                                dataField=""
                            }
                                return '<span class="'+clase+'">'+dataField+'</span>';
                            }
                        },
                        {
                            data: 'redes',
                        },
                        {
                            data: 'agencia_sigla',
                        },
                        {
                            data: 'ir',
                            render: function (dataField) {
                                return '<a href="'+dataField+'">Más</a>';
                            }
                        }
                    ],
    
    
            language: {
                "decimal": "",
                "emptyTable": "No hay información",
                "info": "Mostrando _START_ a _END_ de _TOTAL_ Entradas",
                "infoEmpty": "Mostrando 0 to 0 of 0 Entradas",
                "infoFiltered": "(Filtrado de _MAX_ total entradas)",
                "infoPostFix": "",
                "thousands": ",",
                "lengthMenu": "Mostrar _MENU_ Entradas",
                "loadingRecords": "Cargando...",
                "processing": "Procesando...",
                "search": "Buscar:",
                "zeroRecords": "Sin resultados encontrados",
                "paginate": {
                    "first": "Primero",
                    "last": "Ultimo",
                    "next": "Siguiente",
                    "previous": "Anterior"
                }
            },
    
    
                });
    
                $('#tbl thead th').each(function () {
                var title = $(this).text();
                $(this).html(title+' <input type="text" class="col-search-input" placeholder="Search ' + title + '" />');
            });
            
            table.columns().every(function (i) {
                var table = this;
                $('input', this.header()).on('keyup change', function () {
                    if (table.search() !== this.value) {
    
                        var column="";

                        switch(i){
                            case 0:
                            column="identificador"
                            break;
                            case 1:
                            column="municipio"
                            break;
                            case 2:
                            column="estado"
                            break;
                            case 3:
                            column="redes"
                            break;
                            case 4:
                            column="agencia_sigla"
                            break;
                        }
    
                            texto="+and+"+column+"+like+upper%28%27%25"+this.value+"%25%27%29"
    
                            var uri='https://mapas.igac.gov.co/server/rest/services/centrocontrol/EstacionesGeodesicas/MapServer/0/query?where=es_activa_gnss=1'+texto+'&outFields=identificador%2Cmunicipio%2Cestado%2Credes%2Cagencia_sigla&returnGeometry=false&f=pjson';
    
                            table.ajax.url(uri).load();
    
                           table.search(this.value).draw();
                           console.log(uri)
                    }
                });
            });
    
                
            })
    
              
    </script>





<script type="module">
    import {queryFeatures}  from "https://cdn.skypack.dev/@esri/arcgis-rest-feature-service@4.0.3";
    /* consulta indicador 1 */
    queryFeatures({
        url: "https://mapas.igac.gov.co/server/rest/services/centrocontrol/EstacionesGeodesicas/MapServer/0",
        where: "es_pasiva_gnss=1",
        returnGeometry:'false',
        outStatistics:[{
                statisticType: "sum",
                onStatisticField: "es_pasiva_gnss ",
                outStatisticFieldName: "out"
            }
            ]
        })
        .then((result)=>{
            var obj= result.features[0].attributes;
            document.getElementById('stat1').innerHTML=obj.out;
        })
        /*consulta indicador 2*/
        queryFeatures({
        url: "https://mapas.igac.gov.co/server/rest/services/centrocontrol/EstacionesGeodesicas/MapServer/0",
        where: "es_pasiva_gnss=1",
        returnGeometry:'false',
        groupByFieldsForStatistics:'agencia_sigla',
        returnDistinctValues:true,
        outStatistics:[{
                statisticType: "count",
                onStatisticField: "agencia_sigla",
                outStatisticFieldName: "out"
            }
            ]
        })
        .then((result)=>{
            var obj= result.features[0].attributes;
            document.getElementById('stat2').innerHTML=obj.out;
        })
        /*consulta indicador 3*/
        queryFeatures({
        url: "https://mapas.igac.gov.co/server/rest/services/centrocontrol/EstacionesGeodesicas/MapServer/0",
        where: "estado = 'Activa'",
        returnGeometry:'false',
        groupByFieldsForStatistics:'agencia_sigla',
        returnDistinctValues:true,
        outStatistics:[{
                statisticType: "count",
                onStatisticField: "agencia_sigla",
                outStatisticFieldName: "out"
            }
            ]
        })
        .then((result)=>{
            var obj= result.features.length;
            document.getElementById('stat3').innerHTML=obj;

        })
        /*consulta indicador 4*/
        queryFeatures({
        url: "https://mapas.igac.gov.co/server/rest/services/centrocontrol/EstacionesGeodesicas/MapServer/0",
        where: "es_pasiva_gnss=1",
        returnGeometry:'false',
        groupByFieldsForStatistics:'municipio',
        outStatistics:[{
                statisticType: "count",
                onStatisticField: "municipio",
                outStatisticFieldName: "out"
            }
            ]
        })
        .then((result)=>{
            var obj= result.features;
            console.log(result.features.length);
            var percentaje=Math.round(result.features.length/1132*100).toFixed(0);
            document.getElementById('stat4').innerHTML=percentaje+' %';
        })
</script>





</body>
</html>