<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Centro de Control Geod&eacute;sico Nacional</title>
    <link rel="icon" href="images-home/logos/favicon.png">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css"
        integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.12.1/css/jquery.dataTables.css">
    <link href="../../css/style.css" rel="stylesheet">
    <link href="../../css/maestra.css" rel="stylesheet">
</head>
<body class="main redes geodesicaMaestra redActivaPagina">
    <nav class="navbarigac origen">
    </nav>
    <nav class="nav nav-underline">
    </nav>
    <section class="portada-igac portadaSub redActiva">
        <div class="container block-igac">
            <div class="d-flex contenido-portada">
                <a class="get-back" href="../red_geodesica.html"><img src="/images/iconos/arrow-back.svg" alt=""> Volver
                    a la Red Geodésica GNSS</a>
                <div class="texto-portada">
                    <h1>Red Activa</h1>
                    <p>
                        Est&aacute; compuesta por estaciones GNSS de funcionamiento continuo que proporcionan
                        informaci&oacute;n diaria en el formato Receiver Independent Exchange (RINEX) el cual es un
                        formato que permite su uso en cualquier software de procesamiento GNSS. El IGAC dispone de una
                        red de Estaciones de rastreo contin&uacute;o la cual se encuentra ubicada
                        estrat&eacute;gicamente en el territorio nacional y sirve de base de referencia para los
                        levantamientos diferenciales, al recibir informaci&oacute;n satelital en tiempo real.
                    </p>
                </div>
            </div>
        </div>
    </section>
    <div class="container containerIgac">
        <section class="section visor row">
            <div class="iframe col-md-12">
                <div class="d-flex position-relative align-items-center justify-content-end">
                    <h2 class="title w-divider text-center">Mapa de la Red Activa</h2>
                    <div class="status d-flex position-absolute">
                        <a class="btn mb-4 text-center buttonCem">Ver en CEM</a>
                    </div>
                </div>
                <div id="viewDiv"></div>
            </div>
        </section>
    </div>
    <div class="typeB">
        <div class="container containerIgac">        
            <section class="section">
                <div class="m-auto w-100">
                    <table id="redTable" class="display tableRedes" style="width: 100%;">
                        <thead>
                            <tr class="filterContainer"></tr>
                            <tr>
                                <th>ID</th>
                                <th>Municipio, departamento</th>
                                <th>Estado</th>
                                <th>Nombre de la red</th>
                                <th>Entidad</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>AMTE00BRA</td>
                                <td>Nariño</td>
                                <td>Activo</td>
                                <td>IGb14-Core, ITRF2014</td>
                                <td>EABB</td>
                                <td><a href="interna_red_activa.html">M&aacute;s</a></td>
                            </tr>
                            <tr>
                                <td>AMTE00BRA</td>
                                <td>Caldas</td>
                                <td>Inactivo</td>
                                <td>IGb14, ITRF2014</td>
                                <td>IGAC, SGC</td>
                                <td><a href="interna_red_activa.html">M&aacute;s</a></td>
                            </tr>
                            <tr>
                                <td>AMTE00BRA</td>
                                <td>Bolívar</td>
                                <td>Removida</td>
                                <td>IGb14, ITRF2014</td>
                                <td>DGFI</td>
                                <td><a href="interna_red_activa.html">M&aacute;s</a></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </div>
    </div>    
    <div class="containercolor indicadoresMaestraRedes">
        <div class="container containerIgac borderB">
            <section class="section indicadores">
                <div class="d-fex">
                    <div class="text">
                        <div class="title">
                            Indicadores
                        </div>
                        <p>A continuaci&oacute;n, encontraras algunas cifras importantes respecto al estado y
                            funcionamiento la Red GNSS Activa materializada en el territorio colombiano:</p>
                    </div>
                </div>
                <img src="/images/images-redes/birdIndicadores.svg" alt="">
            </section>
        </div>
        <div class="board">
            <div class="card">
                <div class="d-flex">
                    <div class="item">
                        <div class="d-flex">
                            <div class="icon">
                                <img src="/images/iconos/mapIcon.svg" alt="">
                            </div>
                            <div class="content">
                                <div class="number" id="stat1"></div>
                                <div class="text" id="text1"></div>
                            </div>
                        </div>
                    </div>
                    <div class="item">
                        <div class="d-flex">
                            <div class="icon">
                                <img src="/images/iconos/moveIcon.svg" alt="">
                            </div>
                            <div class="content">
                                <div class="number" id="stat2"></div>
                                <div class="text" id="text2"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="d-flex">
                    <div class="item">
                        <div class="d-flex">
                            <div class="icon">
                                <img src="/images/iconos/tableIcon.svg" alt="">
                            </div>
                            <div class="content">
                                <div class="number" id="stat3"></div>
                                <div class="text" id="text3"></div>
                            </div>
                        </div>
                    </div>
                    <div class="item">
                        <div class="d-flex">
                            <div class="icon">
                                <img src="/images/iconos/dataIcon.svg" alt="">
                            </div>
                            <div class="content">
                                <div class="number" id="stat4"></div>
                                <div class="text" id="text4"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>        
    </div>
    <div class="container block-igac">
        <section class="section pb-0">
            <div class="faqs type2">
                <div class="title">
                    Explora y consulta los servicios en tiempo real disponibles para todos
                </div>
                <div class="resume">
                    Conéctate y usalos servicios de procesamiento en línea de tipo diferencial y los servicios de posicionamiento en tiempo real via caster NTRIP para las estaciones de la Red Activa del Territorio Colombiano. ¿Qué esperas?
                </div>
                <div class="boton-faqs">
                    <a href="/herramientas/servicios.html">Explora estos recursos</a>            
                </div>
            </div>
        </section>
    </div>
    <!--<section class="section overflow-hidden sectionEstaciones">
        <div class="resourses-title" style="text-align: center;">
            <h2>Estaciones de la red</h2>
        </div>
        
        <div class="row">
            <div class="m-auto">
                <table id="redTable" class="display">
                    <thead>
                        <tr class="filterContainer"></tr>
                        <tr>
                            <th>ID</th>
                            <th>Municipio, departamento</th>
                            <th>Estado</th>
                            <th>Nombre de la red</th>
                            <th>Entidad</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>AMTE00BRA</td>
                            <td>Nari&ntilde;o</td>
                            <td>Inactivo</td>
                            <td>IGb14-Core, ITRF2014</td>
                            <td>EABB</td>
                            <td><a href="" class="modalButton" data-toggle="modal"
                                    data-target="#exampleModal">M&aacute;s</a></td>
                        </tr>
                        <tr>
                            <td>AMTE00BRA</td>
                            <td>Nari&ntilde;o</td>
                            <td>Activo</td>
                            <td>IGb14-Core, ITRF2014</td>
                            <td>EABB</td>
                            <td><a href="" class="modalButton" data-toggle="modal"
                                    data-target="#exampleModal">M&aacute;s</a></td>
                        </tr>
                        <tr>
                            <td>AMTE00BRA</td>
                            <td>Antioquia</td>
                            <td>Activo</td>
                            <td>IGb14-Core, ITRF2014</td>
                            <td>EABB</td>
                            <td><a href="" class="modalButton" data-toggle="modal"
                                    data-target="#exampleModal">M&aacute;s</a></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="row">
            <div class="m-auto">
            <table id="tbl" class="display">
                <thead>
                    <tr >
                        <th>Identificador</th>
                        <th>Municipio, departamento</th>
                        <th>Estado</th>
                        <th>Nombre de la red</th>
                        <th>Entidad</th>
                        <th>Ver</th>
                    </tr>
                </thead>
            </table>
        </div>
        </div>
    </section>-->
    <section class="section registrarReportar paddingLast">
        <div class="container containerIgac">
            <div class="d-flex">
                <div class="containerFaqs typeB">
                    <div class="faqs typeC">
                        <div class="title m-0 mb-3">
                            Registra una nueva estaci&oacute;n
                        </div>
                        <div class="d-flex align-items-center modalIntEstacionesActiva" data-toggle="modal"
                            data-target="#modalIntEstacionesActiva">
                            <div class="boton-faqs">
                                <a>Iniciar formulario</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="containerFaqs typeB">
                    <div class="faqs typeD">
                        <div class="title m-0 mb-3">
                            Reporta una novedad
                        </div>
                        <div style="white-space: nowrap;"
                            class="p-0 col-md-4 text-center modalButtonReportar boton-faqs" data-toggle="modal"
                            data-target="#reportarModal">
                            <a>Iniciar formulario</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <div class="containercolor">
        <div class="container containerIgac">
            <section class="section sumary">
                <h2 class="title w-divider">Recursos destacados</h2>
                <div class="divider w-title"></div>
                <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                    <div class="carousel-inner">
                        <div class="carousel-item active">
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="card shadow-sm blue">
                                        <div class="card-header">
                                            <h5>Aplicaciones y Herramientas</h5>
                                        </div>
                                        <div class="card-body">
                                            <h6>MAGNA SIRGAS PRO 5.1</h6>
                                            <p class="card-text">Esta herramienta permite la conversión y transformación
                                                de coordenadas, cálculo de ondulación geoidal, nivelación GPS, cálculos
                                                elipsoidales, cálculo de velocidades y cambio de época para un conjunto
                                                de coordenadas especificadas.</p>
                                            <div class="d-flex align-items-center justify-content-center">
                                                <button type="button" class="btn btn-sm btn-default">Visitar</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card shadow-sm orange">
                                        <div class="card-header">
                                            <h5>Modelos</h5>
                                        </div>
                                        <div class="card-body">
                                            <h6>Modelo Geoidal</h6>
                                            <p class="card-text">Acá, podrás descargar el modelo GEOCOL más reciente
                                                para visualizar las alturas geoidales que se usan en la determinación de
                                                altura físicas en el Territorio Colombiano.</p>
                                            <div class="d-flex align-items-center justify-content-center">
                                                <button type="button" class="btn btn-sm btn-default">Visitar</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card shadow-sm purple">
                                        <div class="card-header">
                                            <h5>Servicios</h5>
                                        </div>
                                        <div class="card-body">
                                            <h6>Servicios en tiempo real</h6>
                                            <p class="card-text">Este módulo direcciona al usuario a la central de
                                                servicios de procesamiento en línea de tipo diferencial y los servicios
                                                de posicionamiento en tiempo real via caster NTRIP para las estaciones
                                                de la Red Activa del Territorio Colombiano.</p>
                                            <div class="d-flex align-items-center justify-content-center">
                                                <button type="button" class="btn btn-sm btn-default">Visitar</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="carousel-item">
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="card shadow-sm blue">
                                        <div class="card-header">
                                            <h5>Aplicaciones y Herramientas</h5>
                                        </div>
                                        <div class="card-body">
                                            <h6>MAGNA SIRGAS PRO 5.1</h6>
                                            <p class="card-text">Esta herramienta permite la conversión y transformación
                                                de coordenadas, cálculo de ondulación geoidal, nivelación GPS, cálculos
                                                elipsoidales, cálculo de velocidades y cambio de época para un conjunto
                                                de coordenadas especificadas.</p>
                                            <div class="d-flex align-items-center justify-content-center">
                                                <button type="button" class="btn btn-sm btn-default">Visitar</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card shadow-sm orange">
                                        <div class="card-header">
                                            <h5>Modelos</h5>
                                        </div>
                                        <div class="card-body">
                                            <h6>Modelo Geoidal</h6>
                                            <p class="card-text">Acá, podrás descargar el modelo GEOCOL más reciente
                                                para visualizar las alturas geoidales que se usan en la determinación de
                                                altura físicas en el Territorio Colombiano.</p>
                                            <div class="d-flex align-items-center justify-content-center">
                                                <button type="button" class="btn btn-sm btn-default">Visitar</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card shadow-sm purple">
                                        <div class="card-header">
                                            <h5>Servicios</h5>
                                        </div>
                                        <div class="card-body">
                                            <h6>Servicios en tiempo real</h6>
                                            <p class="card-text">Este módulo direcciona al usuario a la central de
                                                servicios de procesamiento en línea de tipo diferencial y los servicios
                                                de posicionamiento en tiempo real via caster NTRIP para las estaciones
                                                de la Red Activa del Territorio Colombiano.</p>
                                            <div class="d-flex align-items-center justify-content-center">
                                                <button type="button" class="btn btn-sm btn-default">Visitar</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>
            </section>
        </div>
    </div>
    <footer class="footer origen">
    </footer>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous">
    </script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous">
    </script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.js">
    </script>
    <script src="/index.js"></script>
    <link rel="stylesheet" href="https://js.arcgis.com/4.24/esri/themes/light/main.css">
    <script src="https://js.arcgis.com/4.24/"></script>
    <script>
        require([
            "esri/config",
            "esri/Map",
            "esri/views/MapView",
            "esri/widgets/Home",
            "esri/widgets/ScaleBar",
            "esri/widgets/LayerList",
            "esri/widgets/Legend",
            "esri/widgets/Expand",
            "esri/widgets/Compass",
            "esri/geometry/Extent",
            "esri/layers/MapImageLayer"
        ], (
            esriConfig, Map, MapView, Home, ScaleBar, LayerList, Legend,
            Expand, Compass, Extent, MapImageLayer
        ) => {
            esriConfig.apiKey =
                "AAPK2a2e861a0c794bfdb29a1b4ce47b1583OBbY7CvHSkUPhQ20FG1hZEbAl5GmTTZcs-cyoy2tw5to5j_pJiiTW6J_KRbBx-qS";
            const layer = new MapImageLayer({
                url: "https://mapas.igac.gov.co/server/rest/services/centrocontrol/EstacionesGeodesicas/MapServer",
                sublayers: [{
                    id: 0,
                    visible: true,
                    definitionExpression: "es_activa_gnss =1"
                }]
            });
            const map = new Map({
                layers: [layer],
                basemap: "arcgis-topographic"
            });
            const view = new MapView({
                container: "viewDiv",
                map: map
            });
            const homeBtn = new Home({
                view: view
            });
            const scaleBar = new ScaleBar({
                view: view,
                unit: "dual"
            });
            const layerList = new LayerList({
                view: view
            });
            const legend = new Legend({
                view: view
            });
            const layerListExpand = new Expand({
                view: view,
                content: layerList,
                expanded: false,
                expandTooltip: "Expand LayerList"
            });
            const legendExpand = new Expand({
                view: view,
                content: legend,
                expandTooltip: "Expand Legend",
                expanded: false
            });
            const compass = new Compass({
                view: view,
                visible: false
            });
            view.ui.add(homeBtn, "top-left");
            view.ui.add(scaleBar, "bottom-right");
            view.ui.add(layerListExpand, "top-right");
            view.ui.add(legendExpand, "bottom-left");
            view.ui.add(compass, "top-left");
            layer.when(() => {
                const initialExtent = Extent.fromJSON(layer.sourceJSON.initialExtent);
                view.goTo(initialExtent);
            });
            // load the Compass only when the view is rotated
            view.watch('rotation', function (rotation) {
                if (rotation && !compass.visible) {
                    compass.visible = true;
                }
            });
        });
    </script>
    <script type="module">
        $('#tbl').DataTable({
            orderCellsTop: true,
                serverSide: true,
                ajax: {
                    url: 'https://mapas.igac.gov.co/server/rest/services/centrocontrol/EstacionesGeodesicas/MapServer/0/query?where=es_activa_gnss=1&outFields=identificador%2Cmunicipio%2Cestado%2Credes%2Cagencia_sigla&returnGeometry=false&f=pjson',
                    data: function (d) {
                        d.resultRecordCount = d.length;
                        d.resultOffset=d.start
                    },
                    "dataSrc": function ( json ) {
                        var obj=json.features;
                        var arr1=[]
                        Object.keys(obj).forEach(function(key, index) {
                            obj[key].attributes["id"] = index;
                            obj[key].attributes["ir"] = '/redes/redes_interna/maestra.html?estacion=' + obj[key].attributes.agencia_sigla;
                            arr1.push(obj[key].attributes)
                        });
                        return arr1;
                        },
                },
                columns: [
                    {
                        data: 'identificador'
                    },
                    {
                        data: 'municipio'
                    },
                    {
                        data: 'estado',
                        render: function (dataField) {
                            var clase="inactivo"
                            if(dataField==("Activa")){
                                clase="activo"
                            }else if(dataField==null){
                            clase="vacio";
                            dataField=""
                        }
                            return '<span class="'+clase+'">'+dataField+'</span>';
                        }
                    },
                    {
                        data: 'redes'
                    },
                    {
                        data: 'agencia_sigla'
                    },
                    {
                        data: 'ir',
                        render: function (dataField) {
                            return '<a href="" class="modalButton" data-toggle="modal"                                    data-target="#exampleModal">M&aacute;s</a>';
                        }
                    }
                ],
            });
</script>
<script type="module">
    import {queryFeatures}  from "https://cdn.skypack.dev/@esri/arcgis-rest-feature-service@4.0.3";
    /* consulta indicador 1 */
    queryFeatures({
        url: "https://mapas.igac.gov.co/server/rest/services/centrocontrol/EstacionesGeodesicas/MapServer/0",
        where: "es_activa_gnss =1",
        returnGeometry:'false',
        outStatistics:[{
                statisticType: "sum",
                onStatisticField: "es_activa_gnss ",
                outStatisticFieldName: "out"
            }
            ]
        })
        .then((result)=>{
            var obj= result.features[0].attributes;
            document.getElementById('stat1').innerHTML=obj.out;
            document.getElementById('text1').innerHTML="Número de estaciones CORS integradas a la red";
        })
        /*consulta indicador 2*/
        queryFeatures({
        url: "https://mapas.igac.gov.co/server/rest/services/centrocontrol/EstacionesGeodesicas/MapServer/0",
        where: "es_activa_gnss =1 and estado = 'Activa'",
        returnGeometry:'false',
        outStatistics:[{
                statisticType: "sum",
                onStatisticField: "es_activa_gnss ",
                outStatisticFieldName: "out"
            }
            ]
        })
        .then((result)=>{
            var obj= result.features[0].attributes;
            document.getElementById('stat2').innerHTML=obj.out;
            document.getElementById('text2').innerHTML="Número de estaciones CORS activas";
        })
        /*consulta indicador 3*/
        queryFeatures({
        url: "https://mapas.igac.gov.co/server/rest/services/centrocontrol/EstacionesGeodesicas/MapServer/0",
        where: "estado = 'Activa'",
        returnGeometry:'false',
        groupByFieldsForStatistics:'agencia_sigla',
        returnDistinctValues:true,
        outStatistics:[{
                statisticType: "count",
                onStatisticField: "agencia_sigla",
                outStatisticFieldName: "out"
            }
            ]
        })
        .then((result)=>{
            var obj= result.features.length;
            document.getElementById('stat3').innerHTML=obj;
            document.getElementById('text3').innerHTML="Número de entidades contribuyentes";
        })
        /*consulta indicador 4*/
        queryFeatures({
        url: "https://mapas.igac.gov.co/server/rest/services/centrocontrol/EstacionesGeodesicas/MapServer/0",
        where: "estado = 'Activa'",
        returnGeometry:'false',
        groupByFieldsForStatistics:'municipio',
        outStatistics:[{
                statisticType: "count",
                onStatisticField: "municipio",
                outStatisticFieldName: "out"
            }
            ]
        })
        .then((result)=>{
            var obj= result.features;
            console.log(result.features.length);
            var percentaje=Math.round(result.features.length/1132*100).toFixed(0);
            document.getElementById('stat4').innerHTML=percentaje+' %';
            document.getElementById('text4').innerHTML="Portcentaje de municipios cubiertos";
        })
</script>
</body>
</html>