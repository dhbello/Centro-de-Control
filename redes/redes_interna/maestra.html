<!DOCTYPE html>
<html lang="en">
  <head>
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-JB8FKBC408"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-JB8FKBC408");
    </script>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Centro de Control Geod&eacute;sico Nacional</title>
    <link rel="icon" href="images-home/logos/favicon.png" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link
      rel="stylesheet"
      href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css"
      integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/1.12.1/css/jquery.dataTables.css"
    />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
    <link href="../../css/style.css" rel="stylesheet" />
    <link href="/css/navbar-footer.css" rel="stylesheet">
    <link href="../../css/maestra.css" rel="stylesheet" />
    <style>
      #viewDiv {
        padding: 0;
        margin: 0;
        height: 400px;
        width: 100%;
      }
      #tbl {
        margin-bottom: 0px;
      }
      .tabla {
        display: grid;
      }
      </style>
  </head>
  <body class="main redes geodesicaMaestra">
    <!-- header -->
    <div class="barra_gov">
      <a class="logo-gov" href="https://www.gov.co/home/" target="_blank">
          <img alt="Logo Gov.co" src="/images/nav/header_govco.png">
      </a>
    </div>
    <div class="navbarIgacContainer origen"></div>
    <nav class="nav nav-underline"></nav>
    <section class="portada-igac portadaSub portadaTable origen">
      <div class="container block-igac">
        <div class="d-flex contenido-portada">
          <a class="get-back" href="../red_geodesica.html"
            ><img src="/images/iconos/arrow-back.svg" alt="" /> Volver a la Red
            Geodesica GNSS</a
          >
          <div class="texto-portada">
            <h1 id="titulo">EABB</h1>
            <p>
              Lorem ipsum dolor sit amet consectetur adipisicing elit. Quasi
              possimus, voluptatibus, soluta illo similique asperiores
              cupiditate id hic praesentium eligendi reiciendis esse dignissimos
              consequuntur laboriosam culpa, nulla ratione sit magni.
            </p>
          </div>
        </div>
      </div>
    </section>
    <div class="beforeImage typeB">
      <div class="container containerIgac">
        <section class="section">
          <div class="resourses-title" style="text-align: center">
            <h2 id="titulo_estaciones">Estaciones de EABB</h2>
          </div>
          <div class="row">
            <div class="m-auto">
              <table id="tbl" class="display">
                <thead>
                  <tr>
                    <th>Identificador</th>
                    <th>Municipio, departamento</th>
                    <th>Estado</th>
                    <th>Nombre de la red</th>
                    <th>Entidad</th>
                    <th>Ver</th>
                  </tr>
                </thead>
              </table>
            </div>
          </div>
        </section>
      </div>
    </div>
    <div class="containercolor">
      <div class="container containerIgac">
        <section class="section visor row">
          <div class="iframe col-md-12">
            <div class="d-flex justify-content-between">
              <h2 id="mapa_estaciones" class="title w-divider">
                Mapa de las estaciones de EABB
              </h2>
              <div class="status d-flex">
                <div class="activa active"><p>Activa</p></div>
                <div class="pasiva"><p>Pasiva</p></div>
              </div>
            </div>
            <div id="viewDiv"></div>
          </div>
        </section>
      </div>
    </div>
    <section class="section registrarReportar paddingLast">
      <div class="container containerIgac">
        <div class="d-flex">
          <div class="containerFaqs typeB">
            <div class="faqs typeA">
              <div class="title">Registrar un nuevo vértice o estación</div>
              <div class="d-flex align-items-center">
                <div class="boton-faqs">
                  <a href="#">Iniciar formulario</a>
                </div>
                <a href="#">Solo para funcionarios</a>
              </div>
            </div>
          </div>
          <div class="containerFaqs typeB">
            <div class="faqs typeB">
              <div class="title">Reporta una novedad</div>
              <div
                class="boton-faqs modalButtonReportar"
                data-toggle="modal"
                data-target="#reportarModal"
              >
                <a>Iniciar formulario</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <footer class="footer origen"></footer>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
      integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
      integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
      crossorigin="anonymous"
    ></script>
    <script
      type="text/javascript"
      charset="utf8"
      src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.js"
    ></script>
    <script src="../../index.js"></script>
    <link
      rel="stylesheet"
      href="https://js.arcgis.com/4.24/esri/themes/light/main.css"
    />
    <script src="https://js.arcgis.com/4.24/"></script>
    <script>
      function getParameterByName(name, url) {
        if (!url) url = window.location.href;
        name = name.replace(/[\[\]]/g, "\\$&");
        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
          results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return "";
        return decodeURIComponent(results[2].replace(/\+/g, " "));
      }
      var estacion = getParameterByName("estacion");
      document.getElementById("titulo").innerHTML = estacion;
      document.getElementById("titulo_estaciones").innerHTML =
        "Estaciones de " + estacion;
      document.getElementById("mapa_estaciones").innerHTML =
        "Mapa de las estaciones de " + estacion;
      require([
        "esri/config",
        "esri/Map",
        "esri/views/MapView",
        "esri/widgets/Home",
        "esri/widgets/ScaleBar",
        "esri/widgets/LayerList",
        "esri/widgets/Legend",
        "esri/widgets/Expand",
        "esri/widgets/Compass",
        "esri/geometry/Extent",
        "esri/layers/MapImageLayer",
      ], (
        esriConfig,
        Map,
        MapView,
        Home,
        ScaleBar,
        LayerList,
        Legend,
        Expand,
        Compass,
        Extent,
        MapImageLayer
      ) => {
        esriConfig.apiKey =
          "AAPK2a2e861a0c794bfdb29a1b4ce47b1583OBbY7CvHSkUPhQ20FG1hZEbAl5GmTTZcs-cyoy2tw5to5j_pJiiTW6J_KRbBx-qS";
        const layer = new MapImageLayer({
          url: "https://mapas.igac.gov.co/server/rest/services/centrocontrol/EstacionesGeodesicas/MapServer",
          sublayers: [
            {
              id: 0,
              visible: true,
              definitionExpression: "agencia_sigla ='" + estacion + "'",
            },
          ],
        });
        const map = new Map({
          layers: [layer],
          basemap: "arcgis-topographic",
        });
        const view = new MapView({
          container: "viewDiv",
          map: map,
        });
        const homeBtn = new Home({
          view: view,
        });
        const scaleBar = new ScaleBar({
          view: view,
          unit: "dual",
        });
        const layerList = new LayerList({
          view: view,
        });
        const legend = new Legend({
          view: view,
        });
        const layerListExpand = new Expand({
          view: view,
          content: layerList,
          expanded: false,
          expandTooltip: "Expand LayerList",
          mode: "floating",
        });
        const legendExpand = new Expand({
          view: view,
          content: legend,
          expandTooltip: "Expand Legend",
          expanded: false,
          mode: "floating",
        });
        const compass = new Compass({
          view: view,
          visible: false,
        });
        view.ui.add(homeBtn, "top-left");
        view.ui.add(scaleBar, "bottom-right");
        view.ui.add(layerListExpand, "top-right");
        view.ui.add(legendExpand, "bottom-left");
        view.ui.add(compass, "top-left");
        layer.when(() => {
          const initialExtent = Extent.fromJSON(layer.sourceJSON.initialExtent);
          view.goTo(initialExtent);
        });
        // load the Compass only when the view is rotated
        view.watch("rotation", function (rotation) {
          if (rotation && !compass.visible) {
            compass.visible = true;
          }
        });
      });
      $("#tbl").DataTable({
        orderCellsTop: true,
        serverSide: true,
        ajax: {
          url:
            "https://mapas.igac.gov.co/server/rest/services/centrocontrol/EstacionesGeodesicas/MapServer/0/query?where=agencia_sigla='" +
            estacion +
            "'&outFields=identificador%2Cmunicipio%2Cestado%2Credes%2Cagencia_sigla&returnGeometry=false&f=pjson",
          data: function (d) {
            d.resultRecordCount = d.length;
            d.resultOffset = d.start;
          },
          dataSrc: function (json) {
            var obj = json.features;
            var arr1 = [];
            Object.keys(obj).forEach(function (key, index) {
              obj[key].attributes["id"] = index;
              obj[key].attributes["ir"] =
                "/redes/redes_interna/maestra.html?estacion=" +
                obj[key].attributes.agencia_sigla;
              arr1.push(obj[key].attributes);
            });
            return arr1;
          },
        },
        columns: [
          {
            data: "identificador",
          },
          {
            data: "municipio",
          },
          {
            data: "estado",
            render: function (dataField) {
              var clase = "inactivo";
              if (dataField == "Activa") {
                clase = "activo";
              } else if (dataField == null) {
                clase = "vacio";
                dataField = "";
              }
              return '<span class="' + clase + '">' + dataField + "</span>";
            },
          },
          {
            data: "redes",
          },
          {
            data: "agencia_sigla",
          },
          {
            data: "ir",
            render: function (dataField) {
              return '<a href="" class="modalButton" data-toggle="modal" data-target="#exampleModal">M&aacute;s</a>';
            },
          },
        ],
      });
      var modalContent = (innerHTML = `
    <div class='modal maestraModalRedes fade' id='exampleModal' tabindex='-1' role='dialog' aria-labelledby='exampleModalLabel' aria-hidden='true'>
        <div class='modal-dialog' role='document'>
        <div class='modal-content'>
            <div class='modal-header'>
                <button type='button' class='close' data-dismiss='modal' aria-label='Close'>
                    <span aria-hidden='true'><img src='/../../images/iconos/closeIcon.svg' alt='cerrar'></span>
                </button>
            </div>
            <div class='modal-body'>
                <div class='sumary modalSection mt-4'>
                    <div class='content'>
                        <div class='title'>ID :  AA CR00CRI</div>
                        <p class='locationField'>Locación: <span>Bogota, Cundinamarca</span></p>
                        <p class='status'>Estado: <span>Activa</span></p>
                        <p class='entiti'>Entidad: <span>EABB</span></p>
                        <p class='nameOfRed'>Nombre de la red: <span>Magna Eco</span></p>
                        <p class='red'>Red: <span>Activa</span></p>
                    </div>
                    <div class='button'>Editar</div>
                </div>
                <div class='sumary modalSection'>
                    <div class='content'>
                        <p class='dateInstalation'>Fecha de instalación: <span>DD/MM/AAAA</span></p>
                        <p class='dateActivation'>Fecha de activación: <span>DD/MM/AAAA</span></p>
                        <p class='lastModify'>Última modificación: <span>DD/MM/AAAA</span></p>
                        <div class='d-flex'>
                            <div class='button typeB'>Descargar archivo de registro</div>
                            <div class='button typeB'>Mapa de la Red</div>
                        </div>
                    </div>
                </div>
                <div class='sumary modalSection noBorder'>
                    <div class='content'>
                        <p class='sub-title'>Coordenadas y velocidades</p>
                        <div class='d-flex'>
                            <p class='solution'>Solution:</p>
                            <p class='value'>value</p>
                        </div>
                        <div class='d-flex'>
                            <p class='reference'>Reference Epoch:</p>
                            <p class='value'>2015.0</p>
                        </div>
                        <div class='d-flex mt-4' style='align-items: flex-end; width: 100%; justify-content: space-around;'>
                            <div class='tables w-50' style='padding-right: 10px;'>
                                <div class='item'>
                                    <span class='title'>X:</span>
                                    <span class='value'>644009 0097 + 0.00366 m</span>
                                </div>
                                <div class='item'>
                                    <span class='title'>Y:</span>
                                    <span class='value'>644009 0097 + 0.00366 m</span>
                                </div>
                                <div class='item'>
                                    <span class='title'>Z:</span>
                                    <span class='value'>644009 0097 + 0.00366 m</span>
                                </div>
                            </div>
                            <div class='tables w-50' style='padding-left: 10px;'>
                                <div class='item'>
                                    <span class='title'>Vx:</span>
                                    <span class='value'>644009 0097 + 0.00366 m/a</span>
                                </div>
                                <div class='item'>
                                    <span class='title'>Vy:</span>
                                    <span class='value'>644009 0097 + 0.00366 m/a</span>
                                </div>
                                <div class='item'>
                                    <span class='title'>Vz:</span>
                                    <span class='value'>644009 0097 + 0.00366 m/a</span>
                                </div>
                            </div>
                        </div>
                        <div class='d-flex' style='align-items: flex-end; width: 100%; justify-content: space-around;'>
                            <div class='tables w-50' style='padding-right: 10px;'>
                                <div class='item'>
                                    <span class='title'>X:</span>
                                    <span class='value'>644009 0097 + 0.00366 m</span>
                                </div>
                                <div class='item'>
                                    <span class='title'>Y:</span>
                                    <span class='value'>644009 0097 + 0.00366 m</span>
                                </div>
                                <div class='item'>
                                    <span class='title'>Z:</span>
                                    <span class='value'>644009 0097 + 0.00366 m</span>
                                </div>
                            </div>
                            <div class='tables w-50' style='padding-left: 10px;'>
                                <div class='item'>
                                    <span class='title'>V-north:</span>
                                    <span class='value'>644009 0097 + 0.00366 m/a</span>
                                </div>
                                <div class='item'>
                                    <span class='title'>V-east:</span>
                                    <span class='value'>644009 0097 + 0.00366 m/a</span>
                                </div>
                                <div class='item'>
                                    <span class='title'>V-up:</span>
                                    <span class='value'>644009 0097 + 0.00366 m/a</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class='suamry cta'>Consulta las <a>coordenadas semanales</a></div>
                <div class='datos'>
                    <p>Datos de la estación</p>
                    <div class='chards'>
                        <img src="/images/images-redes/chardExample.svg" alt="">
                    </div>
                </div>
            </div>
        </div>
        </div>
    </div>
    `);
      $("body").append(modalContent);
    </script>
  </body>
</html>
